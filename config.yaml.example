interval: "1m"       # 巡检间隔，可写成 "30s"、"1m"、"5m" 等
slow_latency: "5s"   # 慢请求阈值，超过则从绿降为黄

# 可用率中黄色状态的权重（0-1，默认 0.7）
# 绿色=1.0, 黄色=degraded_weight, 红色=0.0
# 可选配置，不设置则使用默认值 0.7
degraded_weight: 0.7

# ============================================
# 存储配置（支持 SQLite 和 PostgreSQL）
# ============================================
storage:
  type: "sqlite"  # 存储类型："sqlite" 或 "postgres"

  # SQLite 配置（单机部署推荐）
  sqlite:
    path: "monitor.db"  # 数据库文件路径

  # PostgreSQL 配置（K8s/多副本部署推荐）
  # 取消注释以下配置以启用 PostgreSQL
  # postgres:
  #   host: "localhost"
  #   port: 5432
  #   user: "monitor"
  #   password: "monitor_password"  # 建议使用环境变量 MONITOR_POSTGRES_PASSWORD
  #   database: "llm_monitor"
  #   sslmode: "disable"  # 生产环境建议使用 "require"
  #   max_open_conns: 25
  #   max_idle_conns: 5
  #   conn_max_lifetime: "1h"

# ============================================
# 监控任务配置
# ============================================
monitors:
  # --- 88code ---
  - provider: "88code"
    provider_url: "https://88code.com"  # 可选：服务商官网链接，前端可点击跳转
    service: "cc"
    category: "commercial"  # 必填：商业站(commercial) 或 公益站(public)
    sponsor: "团队自有"      # 必填：提供 API Key 的赞助者
    sponsor_url: "https://example.com/sponsor"  # 可选：赞助者链接
    channel: "vip-channel"  # 业务通道标识（可选），用于分类和过滤
    url: "https://api.88code.com/v1/chat/completions"
    method: "POST"
    api_key: "sk-xxxxxxxx"  # 可通过环境变量 MONITOR_88CODE_CC_API_KEY 覆盖
    headers:
      Authorization: "Bearer {{API_KEY}}"
      Content-Type: "application/json"
    body: |
      {
        "model": "claude-3-opus",
        "messages": [{"role": "user", "content": "hi"}],
        "max_tokens": 1
      }

  - provider: "88code"
    service: "cx"
    category: "public"           # 公益站
    sponsor: "社区赞助"          # 由社区赞助者提供
    channel: "standard-channel"
    url: "https://api.88code.com/v1/chat/completions"
    method: "POST"
    api_key: "sk-xxxxxxxx"
    headers:
      Authorization: "Bearer {{API_KEY}}"
      Content-Type: "application/json"
    body: |
      {
        "model": "gpt-4",
        "messages": [{"role": "user", "content": "hi"}],
        "max_tokens": 1
      }
    # 可选：要求响应体包含该关键字才视为成功（语义校验）
    success_contains: "hi"

  # --- DuckCoding (演示不同的 Header 格式) ---
  - provider: "duckcoding"
    service: "cc"
    category: "commercial"
    sponsor: "duckcoding官方"
    channel: "vip-channel"
    url: "https://api.duckcoding.com/v1/messages"
    method: "POST"
    api_key: "sk-duck-xxxx"
    headers:
      x-api-key: "{{API_KEY}}"
      anthropic-version: "2023-06-01"
      content-type: "application/json"
    body: |
      {
        "model": "claude-3-sonnet",
        "max_tokens": 1,
        "messages": [{"role": "user", "content": "hi"}]
      }

  # --- 引用 data/ 目录下 JSON 的示例 ---
  - provider: "demo"
    service: "codex"
    category: "public"
    sponsor: "示例数据"
    channel: "test-channel"
    url: "https://88code.org/openai/v1/responses"
    method: "POST"
    api_key: "sk-demo"
    headers:
      Authorization: "Bearer {{API_KEY}}"
      Content-Type: "application/json"
    body: "!include data/cx_base.json"
